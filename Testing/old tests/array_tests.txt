let array1: SpiralModule =
    {
    name="array1"
    prerequisites=[]
    opens=[]
    description="Do arrays and references work?"
    code=
    """
inl a = ref 0
a := 5
a() |> ignore

inl a = ref () // Is not supposed to be printed due to being ().
a := ()
a()

inl a = ref <| term_cast (inl a, b -> a + b) (int64,int64)
a := term_cast (inl a, b -> a * b) (int64,int64)
a() |> ignore

inl a = array_create int64 10
a 3 <- 2
a 3 |> ignore

inl a = array_create id 3 // Is supposed to be unit and not printed.
a 1 <- id
a 1 |> ignore
    """
    }

let array2: SpiralModule =
    {
    name="array2"
    prerequisites=[array]
    opens=[]
    description="Do the Array constructors work?"
    code=
    """
open Array

empty int64, singleton 2.2
    """
    }

let array3: SpiralModule =
    {
    name="array3"
    prerequisites=[array]
    opens=[]
    description="Do the Array init and fold work?"
    code=
    """
open Array

inl ar = init 6 (inl x -> x+1)
foldl (+) (dyn 0) ar, foldr (*) ar (dyn 1)
    """
    }

let array4: SpiralModule =
    {
    name="array4"
    prerequisites=[array]
    opens=[]
    description="Do the Array map and filter work?"
    code=
    """
open Array

inl ar = init 16 id
map ((*) 2) ar
|> filter ((<) 15)
    """
    }

let array5: SpiralModule =
    {
    name="array5"
    prerequisites=[array]
    opens=[]
    description="Does the Array concat work?"
    code=
    """
open Array

inl ar = init 4 (inl _ -> init 8 id)
concat ar
    """
    }

let array6: SpiralModule =
    {
    name="array6"
    prerequisites=[array]
    opens=[]
    description="Does the Array append work?"
    code=
    """
open Array

inl ar = inl _ -> init 4 id
append (ar (), ar (), ar())
    """
    }

let array8: SpiralModule =
    {
    name="array8"
    prerequisites=[array]
    opens=[]
    description="Does the fold function get duplicated?"
    code=
    """
inl ar = array_create (int64,int64) 128
Array.foldl (inl a,b c,d -> a+c,b+d) (dyn (1,2)) ar
|> inl a,b -> a*b
    """
    }

let array9: SpiralModule =
    {
    name="array9"
    prerequisites=[array]
    opens=[]
    description="Does the string concat work as expected?"
    code=
    """
inl string_format a b = String (format: a args: b)
inl string_concat a b = String (concat: a args: b)
Array.init 8 (string_format "{0}") |> string_concat "; " |> string_format "[|{0}|]" |> dyn |> ignore
(2,2.3,"qwe") |> Tuple.map (string_format "{0}") |> string_concat "; " |> string_format "[{0}]" |> dyn |> ignore
    """
    }
