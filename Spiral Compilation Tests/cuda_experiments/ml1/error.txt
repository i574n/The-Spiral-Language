Error trace on line: 278, column: 9 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
inl main() = test2()
        ^
Error trace on line: 278, column: 14 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
inl main() = test2()
             ^
Error trace on line: 260, column: 10 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
inl test2() =
         ^
Error trace on line: 261, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
    inl m,n : int * int = 16, 64
    ^
Error trace on line: 261, column: 9 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
    inl m,n : int * int = 16, 64
        ^
Error trace on line: 264, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
    inl input : _ _ int = cupy.ones (m,n)
    ^
Error trace on line: 265, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
    inl output_reduce : _ _ int = cupy.zeros 1
    ^
Error trace on line: 266, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
    inl output_map_reduce_replicate_map_2d : _ _ int = cupy.zeros (m,n)
    ^
Error trace on line: 267, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
    run fun _ =>
    ^
Error trace on line: 78, column: 13 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corecuda\base.spi.
inl run f = run' {shared_mem = 0} f
            ^
Error trace on line: 39, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corecuda\base.spi.
    inl blocks_per_grid, threads_per_block = blocks_per_grid(), threads_per_block()
    ^
Error trace on line: 39, column: 9 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corecuda\base.spi.
    inl blocks_per_grid, threads_per_block = blocks_per_grid(), threads_per_block()
        ^
Error trace on line: 43, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corecuda\base.spi.
    global "options = []"
    ^
Error trace on line: 44, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corecuda\base.spi.
    global "options.append('--define-macro=NDEBUG')"
    ^
Error trace on line: 45, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corecuda\base.spi.
    global "options.append('--diag-suppress=550,20012')"
    ^
Error trace on line: 46, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corecuda\base.spi.
    global "options.append('--dopt=on')"
    ^
Error trace on line: 47, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corecuda\base.spi.
    global "options.append('--restrict')"
    ^
Error trace on line: 58, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corecuda\base.spi.
    match threads_per_block with
    ^
Error trace on line: 64, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corecuda\base.spi.
    global "raw_module = cp.RawModule(code=kernel, backend='nvrtc', enable_cooperative_groups=True, options=tuple(options))"
    ^
Error trace on line: 65, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corecuda\base.spi.
    inl kernel_i, vars = join_backend Cuda
    ^
Error trace on line: 67, column: 9 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corecuda\base.spi.
        f () : ()
        ^
Error trace on line: 268, column: 9 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
        inl block = cooperative_groups.create_block()
        ^
Error trace on line: 270, column: 9 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
        reduce 0 (+) input output_reduce
        ^
Error trace on line: 271, column: 9 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
        map_reduce_replicate_map_2d block 0 id (+) (fun _ x => x) input output_map_reduce_replicate_map_2d
        ^
Error trace on line: 107, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
    assert (from.dim = to.dim) "The input and the output tensor dimensions have to be equal."
    ^
Error trace on line: 109, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
    global "#include <cooperative_groups.h>"
    ^
Error trace on line: 110, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
    global "#include <cooperative_groups/reduce.h>"
    ^
Error trace on line: 113, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
    inl from =
    ^
Error trace on line: 114, column: 9 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\ml\primitives.spi.
        from 
        ^
Error trace on line: 57, column: 16 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corebase\core.spi.
inl (|>) a b = b a
               ^
Error trace on line: 59, column: 18 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corebase\core.spi.
inl (>>) a b x = b (a x)
                 ^
Error trace on line: 59, column: 21 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corebase\core.spi.
inl (>>) a b x = b (a x)
                    ^
Error trace on line: 262, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corebase\tensorm\tensor_main.spi.
    inl dim = f (fst t.dim)
    ^
Error trace on line: 262, column: 15 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corebase\tensorm\tensor_main.spi.
    inl dim = f (fst t.dim)
              ^
Error trace on line: 59, column: 18 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corebase\core.spi.
inl (>>) a b x = b (a x)
                 ^
Error trace on line: 59, column: 21 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corebase\core.spi.
inl (>>) a b x = b (a x)
                    ^
Error trace on line: 96, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corebase\loop.spi.
    inl a, (i : int) = real
    ^
Error trace on line: 96, column: 9 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corebase\loop.spi.
    inl a, (i : int) = real
        ^
Error trace on line: 102, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corebase\loop.spi.
    assert (i = 1) "The integer length must be distributed in its entirety."
    ^
Error trace on line: 123, column: 50 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corebase\core.spi.
inl assert (c : bool) (msg : string) : () = real assert c msg
                                                 ^
Error trace on line: 250, column: 5 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corebase\real_core.spir.
    if c = false then 
    ^
Error trace on line: 251, column: 9 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corebase\real_core.spir.
        if lit_is c && lit_is msg then error_type msg
        ^
Error trace on line: 251, column: 40 in module: d:\Users\Marko\Source\Repos\The Spiral Language\Spiral Compilation Tests\cuda_experiments\ml1\corebase\real_core.spir.
        if lit_is c && lit_is msg then error_type msg
                                       ^
The integer length must be distributed in its entirety.