inl main () =
    open leduc
    open nodes
    inl d = dictm.empty
    loopw.for' (from: 0i32 nearTo: 100) fun i =>
        if (i + 1) % 200 = 0 then
            open agent.cfr_enum
            ignore <| leduc.start (nodes.nodes_2p false (funsTrain TrainCurrentPolicy d, funsTrain PlayCurrentPolicy d))
            ignore <| leduc.start (nodes.nodes_2p false (funsTrain PlayCurrentPolicy d, funsTrain TrainCurrentPolicy d))

            inl d_test = dictm.empty
            loopw.for' (from: 0i32 nearTo: 500) fun _ =>
                ignore <| leduc.start (nodes.nodes_2p false (funsTrain TrainCurrentPolicy d_test, funsTrain PlayAvgPolicy d))
            inl r = leduc.start (nodes.nodes_2p false (funsTrain PlayCurrentPolicy d_test, funsTrain PlayAvgPolicy d))
            $"print('summary -',!i,!r)"